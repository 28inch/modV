<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<title>modV</title>
		<link rel="stylesheet" href="modV-stylesheet.css" />
	</head>
	<body>
		<canvas></canvas>

		<script src="./meyda/meyda.min.js"></script>
		<script src="./beatDetektor/beatdetektor.js"></script>
		<script src="./threejs/Three.js"></script>
		<script src="modV.js"></script>
		<script src="./modules/waveform.modV.js"></script>
		<script src="./modules/concentrics.modV.js"></script>
		<script src="./modules/tile.modV.js"></script>
		<script src="./modules/stretch.modV.js"></script>
		<script src="./modules/circles.modV.js"></script>
		<script src="./modules/pixelate.modV.js"></script>
		<script src="./modules/rotate.modV.js"></script>
		<script src="./modules/dither.modV.js"></script>
		<script src="./modules/ball.modV.js"></script>
		<script src="./modules/glitcher.modV.js"></script>
		<script src="./modules/onOff.modV.js"></script>
		<script src="./modules/starField.modV.js"></script>
		<script src="./modules/badHold.modV.js"></script>
		<script src="./modules/rotoZoom.modV.js"></script>
		<script src="./modules/staticImage.modV.js"></script>
		<script src="./modules/slide.modV.js"></script>
		<script src="./modules/tenPrint.modV.js"></script>
		<script src="./modules/webcam.modV.js"></script>
		<script src="./modules/video.modV.js"></script>
		<script src="./modules/relapper.modV.js"></script>
		<script src="./modules/slipNslide.modV.js"></script>
		<script src="./modules/gridStretch.modV.js"></script>
		<script src="./modules/mirror.modV.js"></script>
		<script src="./modules/waveHold.modV.js"></script>
		<script src="./modules/spazulator5000.modV.js"></script>
		<script src="./modules/perl.modV.js"></script>
		<script src="./modules/moonLine.modV.js"></script>
		<script src="./modules/threeJS.modV.js"></script>
		<script>
			var testMod = function() {

				this.info = {
					name: 'testMod',
					author: '2xAA',
					version: 0.1,
					controls: [
						{type: 'text', variable: 'text', label: 'Text'},
						{type: 'range', varType: 'int', min: 50, max: 200, variable: 'size', append: 'pt', label: 'Size'}
					]
				};

				var getTextHeight = function(font) {

					var result = {};

					var text = document.createElement('span');
						text.style.fontFamily = font;
						text.textContent = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';

					var block = document.createElement('div');
						block.style.display = 'inline-block';
						block.style.width = '1px';
						block.style.height = '0px';

					var div = document.createElement('div');
						div.appendChild(text);
						div.appendChild(block);

					document.body.appendChild(div);

					block.style.verticalAlign = 'baseline';
					result.ascent = block.offsetHeight - text.offsetHeight;

					block.style.verticalAlign = 'bottom';
					result.height = block.offsetHeight - text.offsetHeight;

					result.descent = result.height - result.ascent;

					div.remove();

					return result;
				};

				var hue = 0;
				this.text = 'modV';
				this.size = '50pt';
				var font;
				var h = getTextHeight(font);

				setInterval(function() {
					h = getTextHeight(font);
				}, 1000);

				this.draw = function(canvas, ctx) {
					ctx.textBaseline = 'middle';
					font = ctx.font = this.size + ' "Helvetica", sans-serif';
					ctx.textAlign = 'left';
					ctx.fillStyle = 'hsl(' + hue + ', 100%, 50%)';

					var w = ctx.measureText(this.text).width;

					ctx.fillText(this.text, canvas.width/2 - w/2, canvas.height/2 + h.height/2);
					if(hue === 360) hue = 0;
					else hue++;
				};
			};
		</script>
		<script>
			var modV = new modV({previewWindow: false, retina: false});
			modV.setCanvas(document.querySelector('canvas'));
			modV.setDimensions(window.innerWidth, window.innerHeight);

			modV.registerMod(threeJS);
			modV.registerMod(slipNslide);
			modV.registerMod(relapper);
			modV.registerMod(gridStretch);
			modV.registerMod(testMod);
			modV.registerMod(mirror);
			modV.registerMod(waveform);
			modV.registerMod(concentrics);
			modV.registerMod(stretch);
			modV.registerMod(moonLine);
			//modV.registerMod(waveHold);
			modV.registerMod(tile);
			modV.registerMod(pixelate);
			modV.registerMod(rotate);
			modV.registerMod(dither);
			modV.registerMod(ball);
			modV.registerMod(glitcher);
			modV.registerMod(onOff);
			modV.registerMod(starField);
			modV.registerMod(badHold);
			modV.registerMod(slide);
			modV.registerMod(rotoZoom);
			modV.registerMod(staticImage);
			modV.registerMod(tenPrint);
			modV.registerMod(webcam);
			modV.registerMod(video);
			modV.registerMod(circles);
			modV.registerMod(spazulator5000);
			modV.registerMod(perl);

			modV.clearing = false;
			modV.start();
		</script>
	</body>
</html>
